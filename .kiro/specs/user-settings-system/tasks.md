# 使用者設定系統實作計劃

- [x] 1. 建立設定頁面基礎結構和路由
  - 建立設定頁面的目錄結構和基本路由
  - 實作設定頁面的佈局元件
  - _需求: 1.1, 2.1, 3.1, 4.1, 5.1_

- [x] 1.1 建立設定頁面路由結構
  - 建立 `/[locale]/settings/` 目錄和主頁面
  - 建立子頁面路由：preferences, security, avatar, data
  - 設定 Next.js 動態路由和頁面元資料
  - _需求: 1.1_

- [x] 1.2 實作設定頁面佈局元件
  - 建立 SettingsLayout 元件提供一致的頁面結構
  - 實作響應式側邊導航 SettingsNavigation
  - 建立 SettingsHeader 元件顯示頁面標題和描述
  - _需求: 1.1, 2.1_

- [x] 2. 更新 Header 元件整合設定頁面連結
  - 修改 Header 元件中的 Settings 按鈕連結到設定頁面
  - 確保桌面版和行動版都正確導航
  - _需求: 1.1_

- [x] 2.1 修改 Header 元件 Settings 按鈕
  - 將 Settings 按鈕改為 Link 元件
  - 加入正確的 locale 路徑
  - 測試桌面版和行動版導航
  - _需求: 1.1_

- [x] 3. 建立資料模型和 Schema
  - 定義使用者偏好設定的 Zod schema
  - 建立安全設定相關的資料結構
  - 實作頭像管理的資料模型
  - _需求: 2.2, 3.2, 4.2_

- [x] 3.1 建立使用者偏好設定 Schema
  - 定義 UserPreferences 介面和 Zod schema
  - 實作偏好設定的驗證邏輯
  - 建立預設偏好設定值
  - _需求: 2.2_

- [x] 3.2 建立安全設定 Schema
  - 定義密碼變更的 Zod schema
  - 實作安全設定的資料結構
  - 建立帳戶刪除確認的驗證
  - _需求: 3.2, 3.4_

- [x] 3.3 建立頭像管理 Schema
  - 定義檔案上傳的驗證規則
  - 實作圖片格式和大小限制
  - 建立頭像資料的介面定義
  - _需求: 4.2, 4.3_

- [x] 4. 實作個人資料設定頁面
  - 整合現有的 ProfileForm 元件
  - 建立個人資料設定的主頁面
  - 實作資料載入和更新邏輯
  - _需求: 1.2, 1.3, 1.4, 1.5_

- [x] 4.1 建立個人資料設定主頁面
  - 建立 `/settings/page.tsx` 作為個人資料設定頁面
  - 整合現有的 ProfileForm 元件
  - 實作頁面載入狀態和錯誤處理
  - _需求: 1.2, 1.3_

- [x] 4.2 實作個人資料更新邏輯
  - 建立個人資料更新的 Server Action
  - 實作表單提交和驗證邏輯
  - 加入成功和錯誤訊息顯示
  - _需求: 1.3, 1.4, 1.5_

- [x] 5. 實作偏好設定頁面
  - 建立偏好設定的表單元件
  - 實作語言、主題、通知等設定選項
  - 整合現有的 LanguageSwitcher 功能
  - _需求: 2.1, 2.2, 2.3, 2.4_

- [x] 5.1 建立偏好設定頁面和表單
  - 建立 `/settings/preferences/page.tsx`
  - 實作 PreferencesForm 元件
  - 建立語言、主題、通知設定的 UI 元件
  - _需求: 2.1, 2.2_

- [x] 5.2 實作偏好設定更新邏輯
  - 建立偏好設定更新的 Server Action
  - 實作即時設定套用功能
  - 整合現有的語言切換功能
  - _需求: 2.2, 2.3, 2.4_

- [ ] 6. 實作安全設定頁面
  - 建立密碼變更表單
  - 實作帳戶刪除功能
  - 加入安全設定的驗證邏輯
  - _需求: 3.1, 3.2, 3.3, 3.4_

- [ ] 6.1 建立安全設定頁面和密碼變更表單
  - 建立 `/settings/security/page.tsx`
  - 實作 PasswordChangeForm 元件
  - 建立密碼強度驗證和確認邏輯
  - _需求: 3.1, 3.2_

- [ ] 6.2 實作帳戶刪除功能
  - 建立 AccountDeletionForm 元件
  - 實作刪除確認對話框
  - 建立帳戶刪除的 Server Action
  - _需求: 3.4_

- [ ] 7. 實作頭像管理頁面
  - 建立檔案上傳元件
  - 實作圖片預覽和裁切功能
  - 加入頭像更新的後端邏輯
  - _需求: 4.1, 4.2, 4.3, 4.4_

- [ ] 7.1 建立頭像管理頁面和上傳元件
  - 建立 `/settings/avatar/page.tsx`
  - 實作 AvatarUpload 元件
  - 建立拖放上傳和檔案選擇功能
  - _需求: 4.1, 4.2_

- [ ] 7.2 實作頭像處理和儲存邏輯
  - 建立頭像上傳的 Server Action
  - 實作檔案驗證和圖片處理
  - 加入頭像預覽和更新功能
  - _需求: 4.2, 4.3, 4.4_

- [ ] 8. 實作資料管理頁面
  - 建立資料匯出功能
  - 實作資料下載和隱私設定
  - 加入資料使用統計顯示
  - _需求: 5.1, 5.2, 5.3, 5.4_

- [ ] 8.1 建立資料管理頁面和匯出功能
  - 建立 `/settings/data/page.tsx`
  - 實作 DataExport 元件
  - 建立資料匯出的 Server Action
  - _需求: 5.1, 5.2_

- [ ] 8.2 實作資料下載和統計功能
  - 建立資料下載連結生成邏輯
  - 實作資料使用統計顯示
  - 加入隱私設定管理功能
  - _需求: 5.3, 5.4_

- [ ] 9. 加入國際化支援和翻譯
  - 為所有設定頁面加入翻譯鍵值
  - 更新英文和中文翻譯檔案
  - 測試多語言切換功能
  - _需求: 2.2_

- [ ] 9.1 建立設定頁面翻譯內容
  - 在 messages/en.json 和 messages/zh.json 加入 Settings 翻譯
  - 為所有表單欄位和按鈕加入翻譯鍵值
  - 實作錯誤訊息的多語言支援
  - _需求: 2.2_

- [ ] 10. 實作測試和錯誤處理
  - 建立設定頁面的單元測試
  - 實作表單驗證和錯誤處理
  - 加入 E2E 測試覆蓋主要流程
  - _需求: 1.5, 2.4, 3.3, 4.4, 5.4_

- [ ] 10.1 建立設定功能的單元測試
  - 為所有 Server Actions 建立單元測試
  - 測試表單驗證邏輯
  - 實作錯誤處理的測試案例
  - _需求: 1.5, 2.4, 3.3, 4.4, 5.4_

- [ ] 10.2 建立設定頁面的 E2E 測試
  - 建立完整設定流程的 E2E 測試
  - 測試跨頁面導航和資料持久化
  - 實作檔案上傳的測試案例
  - _需求: 1.4, 2.3, 3.2, 4.3, 5.3_